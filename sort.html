<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>排序</title>
</head>
<body>
<span id="list"></span>
<div>
    <canvas id="myCanvas" width="1200" height="500"></canvas>
</div>
<div>
    <input type="button" id="insert" value="插入排序"/>
</div>

<script>
    var list = [],
            len = 30,
            timer = 0,
            delay = 50;

    for (var i = 0; i < len; i++) {
        list.push(Math.round(Math.random() * 400))
    }
    document.getElementById("list").innerHTML = list.toString()
    console.log(list)
    draw(list)

    var c = document.getElementById("myCanvas");
    var cxt = c.getContext("2d");


    function draw(list, redindex, key) {
        timer = timer + delay;
        setTimeout(
                function () {
                    console.log(new Date());
                    list.forEach(
                            function (height, index) {
                                if (redindex == index) {
                                    cxt.fillStyle = "#FF0000";
                                } else {
                                    cxt.fillStyle = "#888888";
                                }
                                cxt.fillRect(index * 20, 500, 20, -height);
                                cxt.fillStyle = "#FFFFFF";
                                cxt.fillRect(index * 20, 500 - height, 20, -500 + height);
                            }
                    )
                    if (key) {
                        cxt.fillStyle = "#000000";
                        cxt.fillRect(len * 20, 500, 20, -key);
                        cxt.fillStyle = "#FFFFFF";
                        cxt.fillRect(len* 20, 500 - key, 20, -500 + key);
                    } else {
                        cxt.fillStyle = "#FFFFFF";
                        cxt.fillRect(len* 20, 500 , 20, -500 );
                    }
                }, new Number(timer)
        )

    }

    //    insertion_sort(list)

    function insertion_sort(list) {
        for (var i = 1; i < len; i++) {
            var j = i - 1;
            var key = list[i];
            while (j >= 0 && list[j] > key) {
                list[j + 1] = list[j];
                draw(list.slice(0, len), j, key)
                j--
            }
            list[j + 1] = key
            draw(list.slice(0, len))
        }
    }

    document.getElementById("insert").onclick = insertion_sort.bind(this, list)
</script>
</body>
</html>